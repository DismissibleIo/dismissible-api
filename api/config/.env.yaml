server:
  port: ${DISMISSIBLE_PORT:-3001}

swagger:
  enabled: ${DISMISSIBLE_SWAGGER_ENABLED:-true}
  path: ${DISMISSIBLE_SWAGGER_PATH:-docs}

helmet:
  enabled: ${DISMISSIBLE_HELMET_ENABLED:-true}
  contentSecurityPolicy: ${DISMISSIBLE_HELMET_CSP:-false}
  crossOriginEmbedderPolicy: ${DISMISSIBLE_HELMET_COEP:-false}
  hstsMaxAge: ${DISMISSIBLE_HELMET_HSTS_MAX_AGE:-31536000}
  hstsIncludeSubDomains: ${DISMISSIBLE_HELMET_HSTS_INCLUDE_SUBDOMAINS:-true}
  hstsPreload: ${DISMISSIBLE_HELMET_HSTS_PRELOAD:-false}

cors:
  enabled: ${DISMISSIBLE_CORS_ENABLED:-true}
  origins: ${DISMISSIBLE_CORS_ORIGINS:-}
  methods: ${DISMISSIBLE_CORS_METHODS:-GET,POST,DELETE,OPTIONS}
  allowedHeaders: ${DISMISSIBLE_CORS_ALLOWED_HEADERS:-Content-Type,Authorization,x-request-id}
  credentials: ${DISMISSIBLE_CORS_CREDENTIALS:-true}
  maxAge: ${DISMISSIBLE_CORS_MAX_AGE:-86400}

storage:
  # postgres | dynamodb | memory
  type: ${DISMISSIBLE_STORAGE_TYPE:-memory}
  memory:
    maxItems: ${DISMISSIBLE_STORAGE_MEMORY_MAX_ITEMS:-5000}
    ttlMs: ${DISMISSIBLE_STORAGE_MEMORY_TTL_MS:-21600000}
  postgres:
    connectionString: ${DISMISSIBLE_STORAGE_POSTGRES_CONNECTION_STRING:-}
  dynamodb:
    tableName: ${DISMISSIBLE_STORAGE_DYNAMODB_TABLE_NAME:-dismissible-items}
    region: ${DISMISSIBLE_STORAGE_DYNAMODB_AWS_REGION:-us-east-1}
    endpoint: ${DISMISSIBLE_STORAGE_DYNAMODB_ENDPOINT:-}
    accessKeyId: ${DISMISSIBLE_STORAGE_DYNAMODB_AWS_ACCESS_KEY_ID:-}
    secretAccessKey: ${DISMISSIBLE_STORAGE_DYNAMODB_AWS_SECRET_ACCESS_KEY:-}
    sessionToken: ${DISMISSIBLE_STORAGE_DYNAMODB_AWS_SESSION_TOKEN:-}

jwtAuth:
  enabled: ${DISMISSIBLE_JWT_AUTH_ENABLED:-false}
  wellKnownUrl: ${DISMISSIBLE_JWT_AUTH_WELL_KNOWN_URL:-}
  issuer: ${DISMISSIBLE_JWT_AUTH_ISSUER:-}
  audience: ${DISMISSIBLE_JWT_AUTH_AUDIENCE:-}
  algorithms: ${DISMISSIBLE_JWT_AUTH_ALGORITHMS:-RS256}
  jwksCacheDuration: ${DISMISSIBLE_JWT_AUTH_JWKS_CACHE_DURATION:-600000}
  requestTimeout: ${DISMISSIBLE_JWT_AUTH_REQUEST_TIMEOUT:-30000}
  priority: ${DISMISSIBLE_JWT_AUTH_PRIORITY:--100}
  matchUserId: ${DISMISSIBLE_JWT_AUTH_MATCH_USER_ID:-true}
  userIdMatchType: ${DISMISSIBLE_JWT_AUTH_USER_ID_MATCH_TYPE:-exact}
  userIdMatchRegex: ${DISMISSIBLE_JWT_AUTH_USER_ID_MATCH_REGEX:-}
  userIdClaim: ${DISMISSIBLE_JWT_AUTH_USER_ID_CLAIM:-sub}

rateLimiter:
  enabled: ${DISMISSIBLE_RATE_LIMITER_ENABLED:-false}
  # Number of requests allowed per duration window
  points: ${DISMISSIBLE_RATE_LIMITER_POINTS:-1000}
  # Time window in seconds for rate limiting
  duration: ${DISMISSIBLE_RATE_LIMITER_DURATION:-1}
  # Optional: Duration in seconds to block requests after limit is exceeded (if not set, requests are allowed again after the duration window resets)
  blockDuration: ${DISMISSIBLE_RATE_LIMITER_BLOCK_DURATION:-60}
  # Key type(s) for rate limiting: 'ip' (by IP address), 'origin' (by Origin header), 'referrer' (by Referer header). Can be comma-separated to combine types (e.g., 'ip,origin')
  keyType: ${DISMISSIBLE_RATE_LIMITER_KEY_TYPE:-ip,origin,referrer}
  # Mode for combining key types: 'and' (combine all), 'or' (use first available), 'any' (check all independently)
  keyMode: ${DISMISSIBLE_RATE_LIMITER_KEY_MODE:-any}
  # Optional: Comma-separated keys to bypass rate limiting. Matching is exact after trim+lowercase. For Origin/Referer, the URL hostname is matched (e.g. "https://google.com/search" matches "google.com").
  ignoredKeys: ${DISMISSIBLE_RATE_LIMITER_IGNORED_KEYS:-}
  # Hook priority (lower numbers run first)
  priority: ${DISMISSIBLE_RATE_LIMITER_PRIORITY:--101}

validation:
  disableErrorMessages: ${DISMISSIBLE_VALIDATION_DISABLE_ERROR_MESSAGES:-true}
  whitelist: ${DISMISSIBLE_VALIDATION_WHITELIST:-true}
  forbidNonWhitelisted: ${DISMISSIBLE_VALIDATION_FORBID_NON_WHITELISTED:-true}
  transform: ${DISMISSIBLE_VALIDATION_TRANSFORM:-true}
